<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Личный кабинет - Россети</title>
    <link rel="stylesheet" href="/static/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        /* Дополнительные стили для улучшенного интерфейса */
        .sidebar {
            transition: transform 0.3s ease, opacity 0.3s ease;
        }
        
        .sidebar.hidden {
            transform: translateX(-100%);
            opacity: 0;
            width: 0;
            padding: 0;
            margin: 0;
            overflow: hidden;
        }
        
        .guest-content {
            animation: fadeIn 0.6s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .action-card {
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }
        
        .action-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        
        .card-icon-container {
            transition: all 0.3s ease;
        }
        
        .action-card:hover .card-icon-container {
            transform: scale(1.1);
            background-color: var(--primary-color);
        }
        
        .action-card:hover .card-icon {
            color: white;
        }
        
        .auth-notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: white;
            border-left: 4px solid var(--primary-color);
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            max-width: 350px;
            z-index: 1000;
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
    </style>
</head>
<body>
    <!-- Шапка -->
    <header class="header">
        <div class="header__logo">
            <a href="/">
                <img src="/static/images/logo.png" alt="Логотип Россети">
            </a>
        </div>
        <nav class="header__nav">
            <ul class="nav-list">
                <li class="nav-item"><a href="/" class="nav-link active"><i class="fas fa-home nav-icon"></i><span class="nav-text">Главная</span></a></li>
                <li class="nav-item"><a href="/about" class="nav-link"><i class="fas fa-info-circle nav-icon"></i><span class="nav-text">О компании</span></a></li>
                <li class="nav-item"><a href="/services" class="nav-link"><i class="fas fa-bolt nav-icon"></i><span class="nav-text">Услуги</span></a></li>
                <li class="nav-item"><a href="/news" class="nav-link"><i class="fas fa-newspaper nav-icon"></i><span class="nav-text">Новости</span></a></li>
            </ul>
        </nav>
        <div class="header__auth">
            <button id="loginBtn" class="auth-btn login-btn" onclick="location.href='/login'">
                <i class="fas fa-sign-in-alt btn-icon"></i>
                <span class="btn-text">Войти</span>
            </button>
            <button id="registerBtn" class="auth-btn register-btn" onclick="location.href='/register'">
                <i class="fas fa-user-plus btn-icon"></i>
                <span class="btn-text">Регистрация</span>
            </button>
            <div id="userPanel" class="user-panel" style="display: none;">
                <span id="userName" class="user-name"></span>
                <button class="logout-btn" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Выйти</span>
                </button>
            </div>
        </div>
        <div class="mobile-menu-toggle">
            <i class="fas fa-bars"></i>
        </div>
    </header>

    <!-- Основной контент -->
    <div class="container">
        <!-- Сайдбар (будет скрыт для гостей) -->
        <div id="sidebar" class="sidebar hidden">
            <div class="user-info">
                <div class="avatar">
                    <i class="fas fa-user-circle avatar-icon"></i>
                    <div class="avatar-pulse"></div>
                </div>
                <h3 id="sidebarUserName" class="user-name">Гость</h3>
                <p id="sidebarUserEmail" class="user-email">Не авторизован</p>
            </div>
            
            <h2 class="sidebar-title"><i class="fas fa-bars title-icon"></i> Меню</h2>
            <ul class="sidebar-menu" id="sidebarMenu">
                <!-- Меню будет заполняться через JavaScript -->
            </ul>
        </div>

        <!-- Контент -->
        <div class="main-content">
            <!-- Гостевой контент -->
            <div id="guest-content" class="content-section guest-content">
                <div class="welcome-container">
                    <h2 class="welcome-title">Добро пожаловать в Россети</h2>
                    <div class="alert info">
                        <div class="alert-content">
                            <i class="fas fa-info-circle alert-icon"></i>
                            <div class="alert-text">Войдите или зарегистрируйтесь для доступа ко всем функциям</div>
                        </div>
                    </div>
                    
                    <div class="guest-actions">
                        <div class="action-card" onclick="location.href='/register'">
                            <div class="card-icon-container">
                                <i class="fas fa-user-plus card-icon"></i>
                            </div>
                            <h3 class="card-title">Регистрация</h3>
                            <p class="card-description">Создайте учетную запись для доступа к личному кабинету</p>
                            <div class="card-arrow">
                                <i class="fas fa-arrow-right"></i>
                            </div>
                        </div>
                        
                        <div class="action-card" onclick="location.href='/login'">
                            <div class="card-icon-container">
                                <i class="fas fa-sign-in-alt card-icon"></i>
                            </div>
                            <h3 class="card-title">Вход</h3>
                            <p class="card-description">Войдите в существующий аккаунт</p>
                            <div class="card-arrow">
                                <i class="fas fa-arrow-right"></i>
                            </div>
                        </div>
                        
                        <div class="action-card" onclick="location.href='/connection-request'">
                            <div class="card-icon-container">
                                <i class="fas fa-plug card-icon"></i>
                            </div>
                            <h3 class="card-title">Подключение</h3>
                            <p class="card-description">Подайте заявку на подключение к электросетям</p>
                            <div class="card-arrow">
                                <i class="fas fa-arrow-right"></i>
                            </div>
                        </div>
                        
                        <div class="action-card" onclick="location.href='/forgot-password'">
                            <div class="card-icon-container">
                                <i class="fas fa-key card-icon"></i>
                            </div>
                            <h3 class="card-title">Восстановить пароль</h3>
                            <p class="card-description">Забыли пароль от аккаунта?</p>
                            <div class="card-arrow">
                                <i class="fas fa-arrow-right"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Контент для авторизованных пользователей -->
            <div id="auth-content" class="content-section" style="display: none;">
                <!-- Здесь будет контент для авторизованных пользователей -->
                <div class="quick-actions">
                    <div class="action-card" onclick="showContent('submitReadings')">
                        <div class="card-icon-container">
                            <i class="fas fa-tachometer-alt card-icon"></i>
                        </div>
                        <h3 class="card-title">Подать показания</h3>
                        <p class="card-description">Заполните текущие показания ваших приборов учета</p>
                        <div class="card-arrow">
                            <i class="fas fa-arrow-right"></i>
                        </div>
                    </div>
                    <div class="action-card" onclick="showContent('receipt')">
                        <div class="card-icon-container">
                            <i class="fas fa-file-invoice card-icon"></i>
                        </div>
                        <h3 class="card-title">Мои квитанции</h3>
                        <p class="card-description">Просмотр и оплата счетов за электроэнергию</p>
                        <div class="card-arrow">
                            <i class="fas fa-arrow-right"></i>
                        </div>
                    </div>
                    <div class="action-card" onclick="showContent('history')">
                        <div class="card-icon-container">
                            <i class="fas fa-history card-icon"></i>
                        </div>
                        <h3 class="card-title">История платежей</h3>
                        <p class="card-description">Архив всех произведенных платежей</p>
                        <div class="card-arrow">
                            <i class="fas fa-arrow-right"></i>
                        </div>
                    </div>
                </div>
                
                <!-- Другие разделы -->
                <div id="profile-content" class="content-section"></div>
                <div id="submitReadings-content" class="content-section"></div>
                <div id="meters-content" class="content-section"></div>
            </div>
        </div>
    </div>

    <!-- Подвал -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer__info">
                <div class="footer-logo">
                    <img src="/static/images/logo-white.png" alt="Россети">
                    <span>Россети</span>
                </div>
                <p class="footer-text">© 2025 Россети. Все права защищены.</p>
                <p class="footer-text"><i class="fas fa-map-marker-alt footer-icon"></i> Москва, ул. Примерная, д. 1</p>
                <p class="footer-text"><i class="fas fa-phone footer-icon"></i> +7 (495) 123-45-67</p>
                
                <div class="social-links">
                    <a href="#" class="social-link"><i class="fab fa-vk"></i></a>
                    <a href="#" class="social-link"><i class="fab fa-telegram"></i></a>
                    <a href="#" class="social-link"><i class="fab fa-youtube"></i></a>
                </div>
            </div>
            <div class="footer__links">
                <div class="links-column">
                    <h4 class="links-title">Компания</h4>
                    <a href="#" class="footer-link">О нас</a>
                    <a href="#" class="footer-link">Руководство</a>
                    <a href="#" class="footer-link">Пресс-центр</a>
                </div>
                <div class="links-column">
                    <h4 class="links-title">Клиентам</h4>
                    <a href="#" class="footer-link">Услуги</a>
                    <a href="#" class="footer-link">Тарифы</a>
                    <a href="#" class="footer-link">Документы</a>
                </div>
                <div class="links-column">
                    <h4 class="links-title">Контакты</h4>
                    <a href="#" class="footer-link">Офисы</a>
                    <a href="#" class="footer-link">Телефоны</a>
                    <a href="#" class="footer-link">Обратная связь</a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <a href="#" class="footer-legal">Политика конфиденциальности</a>
            <a href="#" class="footer-legal">Пользовательское соглашение</a>
        </div>
    </footer>

    <script>
        // Проверка авторизации при загрузке страницы
        document.addEventListener('DOMContentLoaded', function() {
            checkAuth();
            
            // Инициализация меню
            initMenu();
            
            // Инициализация анимаций
            initAnimations();
        });
        
        // Функция проверки авторизации
        function checkAuth() {
            const isAuthenticated = localStorage.getItem('authToken') !== null;
            
            if (isAuthenticated) {
                // Показываем интерфейс для авторизованных пользователей
                document.getElementById('guest-content').style.display = 'none';
                document.getElementById('auth-content').style.display = 'block';
                document.getElementById('sidebar').classList.remove('hidden');
                
                // Обновляем информацию о пользователе
                updateUserInfo();
                
                // Показываем панель пользователя в шапке
                document.getElementById('userPanel').style.display = 'flex';
                document.getElementById('loginBtn').style.display = 'none';
                document.getElementById('registerBtn').style.display = 'none';
            } else {
                // Показываем гостевой интерфейс
                document.getElementById('guest-content').style.display = 'block';
                document.getElementById('auth-content').style.display = 'none';
                document.getElementById('sidebar').classList.add('hidden');
                
                // Показываем кнопки входа/регистрации
                document.getElementById('userPanel').style.display = 'none';
                document.getElementById('loginBtn').style.display = 'block';
                document.getElementById('registerBtn').style.display = 'block';
            }
        }
        
        // Обновление информации о пользователе
        function updateUserInfo() {
            const userData = JSON.parse(localStorage.getItem('userData'));
            if (userData) {
                document.getElementById('userName').textContent = userData.name;
                document.getElementById('sidebarUserName').textContent = userData.name;
                document.getElementById('sidebarUserEmail').textContent = userData.email;
            }
        }
        
        // Инициализация меню
        function initMenu() {
            const menuContainer = document.getElementById('sidebarMenu');
            const isAuthenticated = localStorage.getItem('authToken') !== null;
            
            if (isAuthenticated) {
                // Меню для авторизованных пользователей
                menuContainer.innerHTML = `
                    <li class="menu-item">
                        <a href="#" onclick="showContent('home')" class="menu-link active">
                            <i class="fas fa-home menu-icon"></i>
                            <span class="menu-text">Личный кабинет</span>
                            <i class="fas fa-chevron-right arrow-icon"></i>
                        </a>
                    </li>
                    <li class="menu-item">
                        <a href="#" onclick="showContent('profile')" class="menu-link">
                            <i class="fas fa-user menu-icon"></i>
                            <span class="menu-text">Профиль</span>
                            <i class="fas fa-chevron-right arrow-icon"></i>
                        </a>
                    </li>
                    <li class="menu-item">
                        <a href="#" onclick="showContent('submitReadings')" class="menu-link">
                            <i class="fas fa-tachometer-alt menu-icon"></i>
                            <span class="menu-text">Подать показания</span>
                            <i class="fas fa-chevron-right arrow-icon"></i>
                        </a>
                    </li>
                    <li class="menu-item">
                        <a href="#" onclick="showContent('meters')" class="menu-link">
                            <i class="fas fa-bolt menu-icon"></i>
                            <span class="menu-text">Приборы учёта</span>
                            <i class="fas fa-chevron-right arrow-icon"></i>
                        </a>
                    </li>
                `;
            } else {
                // Меню для гостей (или пустое)
                menuContainer.innerHTML = '';
            }
        }
        
        // Функция выхода
        function logout() {
            localStorage.removeItem('authToken');
            localStorage.removeItem('userData');
            window.location.href = '/';
        }
        
        // Функция показа контента
        function showContent(sectionId) {
            if (!localStorage.getItem('authToken')) {
                showAuthNotification();
                return;
            }
            
            // Скрываем все секции
            document.querySelectorAll('.content-section').forEach(section => {
                section.style.display = 'none';
            });
            
            // Показываем нужную секцию
            const targetSection = document.getElementById(sectionId + '-content');
            if (targetSection) {
                targetSection.style.display = 'block';
            }
        }
        
        // Уведомление о необходимости авторизации
        function showAuthNotification() {
            const notification = document.createElement('div');
            notification.className = 'auth-notification';
            notification.innerHTML = `
                <div class="notification-content">
                    <i class="fas fa-exclamation-circle"></i>
                    <span>Для доступа к этому разделу необходимо авторизоваться</span>
                    <div class="notification-actions">
                        <button onclick="location.href='/login'" class="btn btn-sm btn-primary">Войти</button>
                        <button onclick="location.href='/register'" class="btn btn-sm btn-outline">Регистрация</button>
                    </div>
                </div>
            `;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                setTimeout(() => notification.remove(), 300);
            }, 5000);
        }
        
        // Инициализация анимаций
        function initAnimations() {
            // Анимация карточек
            const cards = document.querySelectorAll('.action-card');
            cards.forEach((card, index) => {
                card.style.animationDelay = `${index * 0.1}s`;
            });
        }
    </script>
</body>
</html>